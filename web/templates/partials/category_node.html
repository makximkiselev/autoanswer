<li class="node" data-id="{{ cat.id }}">
  <div class="title">
    {{ cat.name }}
    <div class="actions">
      <button onclick="toggleForm(this, 'cat', {{ cat.id }})">‚ûï</button>
      <form method="post" action="/catalog/edit/rename-category">
        <input type="hidden" name="category_id" value="{{ cat.id }}">
        <input type="text" name="new_name" placeholder="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å">
        <button type="submit">‚úèÔ∏è</button>
      </form>
      <form method="post" action="/catalog/edit/delete-category">
        <input type="hidden" name="category_id" value="{{ cat.id }}">
        <button class="delete" type="submit">üóëÔ∏è</button>
      </form>
    </div>
  </div>

  {% if cat.children %}
    <!-- –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <ul class="tree nested-sortable">
      {% for child in cat.children %}
        {% include "partials/category_node.html" with context %}
      {% endfor %}
    </ul>
  {% endif %}

  <form class="form-inline hidden" data-form="cat-{{ cat.id }}" method="post" action="/catalog/edit/add-category">
    <input type="hidden" name="parent_id" value="{{ cat.id }}">
    <input type="text" name="name" placeholder="–ù–æ–≤–∞—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è" required>
    <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
  </form>

  <!-- –ë—Ä–µ–Ω–¥—ã (–≤—Å–µ–≥–¥–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏) -->
  {% for brand in cat.brands %}
    <div class="nested">
      üè∑Ô∏è {{ brand.name }}
      <div class="actions">
        <button onclick="toggleForm(this, 'brand', {{ brand.id }})">‚ûï</button>
        <form method="post" action="/catalog/edit/rename-brand">
          <input type="hidden" name="brand_id" value="{{ brand.id }}">
          <input type="text" name="new_name" placeholder="–ù–æ–≤–æ–µ –∏–º—è">
          <button type="submit">‚úèÔ∏è</button>
        </form>
        <form method="post" action="/catalog/edit/delete-brand">
          <input type="hidden" name="brand_id" value="{{ brand.id }}">
          <button class="delete" type="submit">üóëÔ∏è</button>
        </form>
      </div>

      {% for model in brand.models %}
        <div class="nested" style="margin-left: 30px;">
          üì¶ {{ model.name }}
          <div class="actions">
            <button onclick="toggleForm(this, 'model', {{ model.id }})">‚ûï</button>
            <form method="post" action="/catalog/edit/rename-model">
              <input type="hidden" name="model_id" value="{{ model.id }}">
              <input type="text" name="new_name" placeholder="–ù–æ–≤–æ–µ –∏–º—è">
              <button type="submit">‚úèÔ∏è</button>
            </form>
            <form method="post" action="/catalog/edit/delete-model">
              <input type="hidden" name="model_id" value="{{ model.id }}">
              <button class="delete" type="submit">üóëÔ∏è</button>
            </form>
          </div>

          {% for product in model.products %}
            <div class="nested" style="margin-left: 30px; background: #fefefe;">
              üßæ {{ product.name }}
              {% if product.article %}
                <br><span class="dim">–ê—Ä—Ç–∏–∫—É–ª: {{ product.article }}</span>
              {% endif %}
              <div class="actions">
                <form method="post" action="/catalog/edit/rename-product">
                  <input type="hidden" name="product_id" value="{{ product.id }}">
                  <input type="text" name="new_name" placeholder="–ù–æ–≤–æ–µ –∏–º—è">
                  <button type="submit">‚úèÔ∏è</button>
                </form>
                <form method="post" action="/catalog/edit/delete-product">
                  <input type="hidden" name="product_id" value="{{ product.id }}">
                  <button class="delete" type="submit">üóëÔ∏è</button>
                </form>
              </div>
            </div>
          {% endfor %}

          <form class="form-inline hidden" data-form="model-{{ model.id }}" method="post" action="/catalog/edit/add-product" style="margin-left: 30px;">
            <input type="hidden" name="model_id" value="{{ model.id }}">
            <input type="text" name="name" placeholder="–¢–æ–≤–∞—Ä" required>
            <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
          </form>
        </div>
      {% endfor %}

      <form class="form-inline hidden" data-form="brand-{{ brand.id }}" method="post" action="/catalog/edit/add-model" style="margin-left: 30px;">
        <input type="hidden" name="brand_id" value="{{ brand.id }}">
        <input type="text" name="name" placeholder="–ú–æ–¥–µ–ª—å" required>
        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
      </form>
    </div>
  {% endfor %}

  <form class="form-inline hidden" data-form="cat-brand-{{ cat.id }}" method="post" action="/catalog/edit/add-brand">
    <input type="hidden" name="category_id" value="{{ cat.id }}">
    <input type="text" name="name" placeholder="–ë—Ä–µ–Ω–¥" required>
    <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
  </form>
</li>
